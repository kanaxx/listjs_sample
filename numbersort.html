<html>
<body>
<div id="tableID">
    
  <table id="tableid" class="table-list" data-currentpage="1">
    <thead>
      <tr>
        <th><button type="button" class="sort" data-sort="id_name">Parish Name <i class="caret"></i></button></th>
        <th style="width: 140px;"><button type="button" class="sort" data-sort="id_town">Town <i class="caret"></i></button></th>
        <th style="width: 80px;"><button type="button" class="sort" data-sort="id_give">Givers <i class="caret"></i></button></th>
        <th style="width: 120px;"><button type="button" class="sort" data-sort="id_comm">Commitment <i class="caret"></i></button></th>
        <th style="width: 120px;"><button type="button" class="sort" data-sort="id_paid">Paid to Date <i class="caret"></i></button></th>
        <th style="width: 120px;"><button type="button" class="sort" data-sort="id_goal">Goal <i class="caret"></i></button></th>
        <th style="width: 100px;"><button type="button" class="sort" data-sort="id_perc">Percent <i class="caret"></i></button></th>
      </tr>
    </thead>
            
    <tbody class="list">
      <tr><td class='id_name'>002, Blessed Sacrament                   </td><td class='id_town'>Rochester                     </td><td class='id_give'>107</td><td class='id_comm'>$35,862.00</td><td class='id_paid'>$34,904.00</td><td class='id_goal'>$73,822.00</td><td class='id_perc' data-perc='0.4858'>48.58%</td></tr>
      <tr><td class='id_name'>007, Holy Apostles                       </td><td class='id_town'>Rochester                     </td><td class='id_give'>43</td><td class='id_comm'>$9,365.00</td><td class='id_paid'>$8,246.00</td><td class='id_goal'>$22,088.00</td><td class='id_perc' data-perc='0.4220'>42.40%</td></tr>
      <tr><td class='id_name'>008, Holy Cross                          </td><td class='id_town'>Rochester                     </td><td class='id_give'>400</td><td class='id_comm'>$88,431.00</td><td class='id_paid'>$65,548.50</td><td class='id_goal'>$106,530.00</td><td class='id_perc' data-perc='0.8301'>83.01%</td></tr>
      <tr><td class='id_name'>014, Immaculate Conception               </td><td class='id_town'>Rochester                     </td><td class='id_give'>11</td><td class='id_comm'>$2,245.00</td><td class='id_paid'>$1,457.50</td><td class='id_goal'>$9,909.00</td><td class='id_perc' data-perc='0.2266'>22.66%</td></tr>
      <tr><td class='id_name'>017, Our Lady of Lourdes                 </td><td class='id_town'>Rochester                     </td><td class='id_give'>1</td><td class='id_comm'>$1,000.00</td><td class='id_paid'>$1,000.00</td><td class='id_goal'>$64,288.00</td><td class='id_perc' data-perc='0.0156'>1.56%</td></tr>
      <tr><td class='id_name'>021, Our Lady Queen of Peace             </td><td class='id_town'>Rochester                     </td><td class='id_give'>90</td><td class='id_comm'>$33,262.00</td><td class='id_paid'>$31,059.50</td><td class='id_goal'>$64,653.00</td><td class='id_perc' data-perc='0.5145'>51.45%</td></tr>
      <tr><td class='id_name'>022, Our Lady of Victory Church          </td><td class='id_town'>Rochester                     </td><td class='id_give'>21</td><td class='id_comm'>$4,300.00</td><td class='id_paid'>$3,825.00</td><td class='id_goal'>$33,848.00</td><td class='id_perc' data-perc='0.1270'>12.70%</td></tr>
      <tr><td class='id_name'>058, Emmanuel Church of the Deaf         </td><td class='id_town'>Rochester                     </td><td class='id_give'>6</td><td class='id_comm'>$1,045.00</td><td class='id_paid'>$745.00</td><td class='id_goal'>$4,244.00</td><td class='id_perc' data-perc='0.2462'>24.62%</td></tr>
      <tr><td class='id_name'>204, Holy Family                         </td><td class='id_town'>Auburn                        </td><td class='id_give'>82</td><td class='id_comm'>$8,364.00</td><td class='id_paid'>$7,464.00</td><td class='id_goal'>$35,076.00</td><td class='id_perc' data-perc='0.2385'>23.85%</td></tr>
      <tr><td class='id_name'>205, Sacred Heart                        </td><td class='id_town'>Auburn                        </td><td class='id_give'>86</td><td class='id_comm'>$10,935.00</td><td class='id_paid'>$10,615.00</td><td class='id_goal'>$43,941.00</td><td class='id_perc'  data-perc='0.2489'>24.89%</td></tr>
      <tr><td class='id_name'>207, St. Alphonsus                       </td><td class='id_town'>Auburn                        </td><td class='id_give'>136</td><td class='id_comm'>$23,338.00</td><td class='id_paid'>$18,855.50</td><td class='id_goal'>$55,508.00</td><td class='id_perc'  data-perc='0.4204'>42.04%</td></tr>
      <tr><td class='id_name'>210, St. Mary Church                     </td><td class='id_town'>Auburn                        </td><td class='id_give'>195</td><td class='id_comm'>$31,950.00</td><td class='id_paid'>$29,860.00</td><td class='id_goal'>$70,717.00</td><td class='id_perc' data-perc='0.4518'>45.18%</td></tr>
      <tr><td class='id_name'>212, St. Agnes                           </td><td class='id_town'>Avon                          </td><td class='id_give'>63</td><td class='id_comm'>$10,745.00</td><td class='id_paid'>$9,235.00</td><td class='id_goal'>$34,426.00</td><td class='id_perc'  data-perc='0.3121'>31.21%</td></tr>
      <tr><td class='id_name'>215, Nativity of the Blessed Virgin Mary </td><td class='id_town'>Brockport                     </td><td class='id_give'>123</td><td class='id_comm'>$34,365.00</td><td class='id_paid'>$27,908.75</td><td class='id_goal'>$46,071.00</td><td class='id_perc' data-perc='0.7459'>74.59%</td></tr>
      <tr><td class='id_name'>233, Holy Cross                          </td><td class='id_town'>Freeville                     </td><td class='id_give'>27</td><td class='id_comm'>$6,695.00</td><td class='id_paid'>$5,538.75</td><td class='id_goal'>$19,449.00</td><td class='id_perc'  data-perc='0.3442'>34.42%</td></tr>
      <tr><td class='id_name'>237, St. Jerome                          </td><td class='id_town'>East Rochester                </td><td class='id_give'>139</td><td class='id_comm'>$35,378.73</td><td class='id_paid'>$26,531.23</td><td class='id_goal'>$82,090.00</td><td class='id_perc' data-perc='0.4310'>43.10%</td></tr>
      <tr><td class='id_name'>248, Church of the Assumption            </td><td class='id_town'>Fairport                      </td><td class='id_give'>309</td><td class='id_comm'>$76,717.00</td><td class='id_paid'>$66,247.00</td><td class='id_goal'>$234,388.00</td><td class='id_perc'  data-perc='0.3273'>32.73%</td></tr>
      <tr><td class='id_name'>249, St. John of Rochester               </td><td class='id_town'>Fairport                      </td><td class='id_give'>447</td><td class='id_comm'>$125,104.25</td><td class='id_paid'>$112,325.75</td><td class='id_goal'>$242,708.00</td><td class='id_perc' data-perc='0.5155'>51.55%</td></tr>
      <tr><td class='id_name'>255, St. Anthony Church                  </td><td class='id_town'>Groton                        </td><td class='id_give'>32</td><td class='id_comm'>$4,567.00</td><td class='id_paid'>$3,527.00</td><td class='id_goal'>$9,812.00</td><td class='id_perc' data-perc='0.4655'>46.55%</td></tr>
      <tr><td class='id_name'>259, St. Leo                             </td><td class='id_town'>Hilton                        </td><td class='id_give'>122</td><td class='id_comm'>$38,163.00</td><td class='id_paid'>$24,613.00</td><td class='id_goal'>$70,586.00</td><td class='id_perc' data-perc='0.5407'>54.07%</td></tr>
      <tr><td class='id_name'>260, St. Marys                           </td><td class='id_town'>Honeoye                       </td><td class='id_give'>45</td><td class='id_comm'>$7,332.00</td><td class='id_paid'>$6,312.00</td><td class='id_goal'>$15,200.00</td><td class='id_perc' data-perc='0.4824'>48.24%</td></tr>
      <tr><td class='id_name'>261, St. Paul of the Cross               </td><td class='id_town'>Honeoye Falls                 </td><td class='id_give'>30</td><td class='id_comm'>$10,850.00</td><td class='id_paid'>$9,950.00</td><td class='id_goal'>$21,100.00</td><td class='id_perc'  data-perc='0.5142'>51.42%</td></tr>
      <tr><td class='id_name'>347, CLOSED Blessed Sacrament            </td><td class='id_town'>Elmira                        </td><td class='id_give'>1</td><td class='id_comm'>$50.00</td><td class='id_paid'>$50.00</td><td class='id_goal'>$1.00</td><td class='id_perc' data-perc='5.0000'>5,000.00%</td></tr>
    </tbody>
  </table>  
</div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
<script>
  var options = {
    valueNames: [ 'id_name', 'id_town', 'id_give', 'id_comm', 'id_paid', 'id_goal', 
      { name: 'id_perc', attr: 'data-perc' },
    ],

    //direct to List.js to use original sort function.
    sortFunction: my_sort,
  };
  var tableList = new List('tableID', options);
  var sort_2nd = 'id_perc';

//definel my original function
  function my_sort(itemA, itemB, options){
    sort_column = options.valueName;
    v1 = itemA.values()[sort_column].trim();
    v2 = itemB.values()[sort_column].trim();

    console.log(options);
    console.count("sort count");

    sort_result = 0;
    if( sort_column == 'id_name' || sort_column =='id_town'){
      sort_result = my_naturalsort(v1,v2);
    }else{
      sort_result = my_numbersort(v1,v2);
    }
    console.log('1st sort; %s, %s -> %s', v1, v2, sort_result);

    if( sort_result != 0){
      return sort_result;
    }

    //try 2nd sort because 1st sort is same result.
    p1 = itemA.values()[sort_2nd];
    p2 = itemB.values()[sort_2nd];
    console.log('2nd sort; %s(%s), %s(%s)', v1, p1, v2, p2);
    sort_result = my_naturalsort(p1,p2);
    
    //always desc sort by 2nd sort key. 
    if( options.order =='asc'){
      return (-1)*sort_result;
    }else{
      return sort_result;
    }
  }

//call build-in List.js function
  function my_naturalsort(a,b){
    return tableList.utils.naturalSort(a,b)
  }

//sort after removing noisy char.
  function my_numbersort(a,b){
    console.log('A=%s, B=%s, result=%s', a,b, my_naturalsort(a,b));

    s1 = a.replace( '$', '' ).replace(',','');
    s2 = b.replace( '$', '' ).replace(',','');
    console.log('A=%s, B=%s, result=%s ', s1,s2, my_naturalsort(s1,s2));

    f1 = parseFloat(s1);
    f2 = parseFloat(s2);
    console.log('A=%s, B=%s', f1,f2, my_naturalsort(f1,f2));
    return my_naturalsort(f1, f2);
  }
</script>
  
<style>
/* style for sort */
  .sort.desc:after {
    content:"▼";
  }
  .sort.asc:after {
    content:"▲";
  }
</style>

</body>
</html>
